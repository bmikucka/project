# SprotFTdist


## Directories and files present in main distribution folder

### Files
* **inputs.dat, inputs_updated.dat** - Used for RunWekaFromJSON.sh

### Directories
* **data** - Includes HumVar dataset used for analaysis and the results of best machine learning testing runs

### Programs and scripts
* **sprotFTdist.py, sprotFTdist_lib.py, sprotFTdist.c**  - SprotFTdist module analysis
* **CreateTrainTest.pl** - Used in RunWekaFromJSON.sh, creates training and testing datasets
* **RunWekaFromJSON.sh** - Converts and cleans JSON files to csv files and runs Machine Learning training and testing in Weka
* **join_csv.sh** - Used in RunWekaFromJSON.sh, joins csv files
* **json2csv_uniprot_allPDB_pl.txt** - Used in RunWekaFromJSON.sh, converts JSON files to csv
* **cleanjson.pl** - Used in RunWekaFromJSON.sh, cleans JSON files
* **xvalidate.pl** - Used in RunWekaFromJSON.sh, splits csv file and ensures no structural overlap between subsets

* **get_mcc.py** - Extracts testing MCC results from Weka files into a results file
* **mcc_avg.py** - Returns the mean and stdev values for data in mcc_results files
* **mcc_stats.py** - Performs Shapiro-Wilk and Mann-Whitney U Test on MCC results data
* **fix_csv.py** - Currently not included in analysis, caps all distances at 15 in csv files


## SprotFTdist module
Calculates the distance of mutant residue to the closest SwissProt feature. 
Runs by taking a PDB file and a mutation as input and produces JSON as output
* **To run:** sprotfeatures.py [chain]resnum[insert] newaa pdbfile
* Ensure Atomium is installed. Instructions: https://atomium.bio/installing.html
* PDB files analysed must be locally downloaded

## Running SAAPdap with SprotFTdist
To instal and run SAAPdap follow the instructions: https://github.com/ACRMGroup/SAAP3/blob/master/README.md
* Drop SprotFTdist (sprotFTdist.py and sprotFTdist_lib.py or sprotFTdist.c) into the **plugin** directory
* Ensure the dataset is in the directory the command is run from
* **To run on PD dataset:** multiUniprotPipeline PD humvar-2011_12.deleterious.pph.txt &>> humvar-2011_12.deleterious.pph.log &
* **To run on SNP dataset:** multiUniprotPipeline SNP humvar-2011_12.neutral.pph.txt &>> humvar-2011_12.neutral.pph.log &

## Running Machine Learning (SAAPpred)
SAAPpred is trained using Random Forest in Weka. This can be run using RunWekaFromJSON.sh from JSON files (generated by SAAPdap).
* **To run:** RunWekaFromJSON.sh x NTREE NFT DEPTH &> RUNX_WekaFromJSON.log &
* **Input:** x - cross-validation number; NTREE - ML number of trees; NFT - ML number of features; DEPTH - ML depth
* **Run SAAPpred with SprotFTdist:** use inputs_updated.dat in RunWekaFromJSON.sh script
* **Run SAAPpred without SprotFTdist:** replace inputs_updated.dat with inputs.dat in RunWekaFromJSON.sh script
* Ensure the following scripts are downloaded as they are used by RunWekaFromJSON.sh: json2csv_uniprot_allPDB.pl, join_csv.sh, xvalidate.pl, CreateTrainTest.pl, cleanjson.pl
* Uses csv2arff and Weka



